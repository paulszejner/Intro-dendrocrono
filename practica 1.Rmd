---
title: "Introduccion a la Dendrocronologia en R"
output: html_notebook
---
#### Clase intro a la Dendrocronologia

###### Instrucciones
bla bla 
bla bla

en cada seccion  podras  ejecutar y analizar   los comandos  basicos para  leer, visualisar y realizar  los analisis baicos utilizados en Dendrocronologia.  la mayoria de analisis que se llevaran acabo son iguales o muy similares a los que COFECHA y ARSTAN  pueden ejecutar. En este caso utilizaremos el  ambiente de R y utilizaremso  el paquete dplR  programado y desarrollado por Andy Bunn y Mikko Korpela 2014 (https://drive.google.com/uc?export=download&id=1ps7tZ0RTwuIr2P_h-ugHkbgAs3Jrdxaa)

La idea de estos ejercicios es que puedas familiarizarte con este tipo de ambiente, y  puedas aprender haciendo....


A continuacion vamos a instalr y activar el dplR y se conectaran a la base de datos del ITRDB mediante la web

```{r}
#install.packages(dplR)
library(dplR) # libreria para analisis dendrocronologicos

Dat_ringwidth <- read.rwl("https://www.ncei.noaa.gov/pub/data/paleo/treering/measurements/northamerica/mexico/mexi042.rwl")
Dat_Earlywood <- read.rwl("https://www.ncei.noaa.gov/pub/data/paleo/treering/measurements/northamerica/mexico/mexi042e.rwl")
Dat_latewood <- read.rwl("https://www.ncei.noaa.gov/pub/data/paleo/treering/measurements/northamerica/mexico/mexi042l.rwl")

#Tambien se puede bajar  desde los FPTs del NOAA
#Dat_ftp <- read.rwl("ftp://ftp.ncdc.noaa.gov/pub/data/paleo/treering/measurements/northamerica/mexico/mexi042.rwl")

str(Dat_ringwidth) # str te da la estructura del objeto llamado Datos
```



```{r}
# ## Graficar los datos  Control de calidad otra prueba que los dos archivos son iguales -------------------------------

plot.ts(Dat__ringwidth[,20])
plot.ts((Dat_ringwidth[,2]), col="darkred")
plot.ts((Dat_ringwidth[,3]), col="darkred")
plot.ts((Dat_ringwidth[,6]), col="darkred")

```


```{r}
# cuantas series de tiempo estan en este archivo?
n_series <- ncol(Dat_ringwidth)
# ahora hacemos un plot con todas las serias  en su estado crudo o RAW  sin ningun tratamiento alguno
plot.ts(Dat_ringwidth[,20])
for(s in 1:n_series){lines(Dat_ringwidth[,s])  }
```

en dplR  hay otras opciones  para haccer esto  y de mejor  manera!  por ejemplo   con mas orden y con algunas caracteristicas  que pueden ser utiles

```{r}
spag.plot(Dat_ringwidth, zfac = 1)
spag.plot(Dat_ringwidth, zfac = 3)
spag.plot(Dat_ringwidth, zfac = 0.3)
spag.plot(Dat_Earlywood, zfac = 0.3)
spag.plot(Dat_latewood, zfac = 0.3)

```



